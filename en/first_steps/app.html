
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The first application &mdash; Django 101 Tutorial</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Django 101 Tutorial" href="../index.html" />
    <link rel="up" title="Erste Schritte mit Django" href="index.html" />
    <link rel="next" title="The admin application" href="admin.html" />
    <link rel="prev" title="Development Webserver" href="testserver.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="admin.html" title="The admin application"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="testserver.html" title="Development Webserver"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Django 101 Tutorial</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Erste Schritte mit Django</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-first-application">
<h1>The first application<a class="headerlink" href="#the-first-application" title="Permalink to this headline">¶</a></h1>
<p>Now we start with the first application for our <em>Cookbook</em> project.</p>
<p>Here is the data model:</p>
<p class="graphviz">
<img src="../_images/graphviz-b80512f431c537d3f35b079932ae80e48eaf1185.png" alt="digraph name {
  fontname = &quot;Helvetica&quot;
  fontsize = 8

  node [
    fontname = &quot;Helvetica&quot;
    fontsize = 8
    shape = &quot;plaintext&quot;
  ]
  edge [
    fontname = &quot;Helvetica&quot;
    fontsize = 8
  ]



subgraph cluster_recipes_models {
  label=&lt;
        &lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
        &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;Black&quot; POINT-SIZE=&quot;12&quot;
        &gt;recipes&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
        &lt;/TABLE&gt;
        &gt;
  color=olivedrab4
  style=&quot;rounded&quot;


    recipes_models_Category [label=&lt;
    &lt;TABLE BGCOLOR=&quot;palegoldenrod&quot; BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
     &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot; BGCOLOR=&quot;olivedrab4&quot;
     &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;white&quot;
     &gt;Category&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
    
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;id&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;AutoField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;name&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;CharField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;slug&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;SlugField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;description&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;TextField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
    
    &lt;/TABLE&gt;
    &gt;]

    recipes_models_Recipe [label=&lt;
    &lt;TABLE BGCOLOR=&quot;palegoldenrod&quot; BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
     &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot; BGCOLOR=&quot;olivedrab4&quot;
     &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;white&quot;
     &gt;Recipe&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
    
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;id&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;AutoField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;title&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;CharField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;slug&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;SlugField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;ingredients&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;TextField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;preparation&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;TextField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;time_for_preparation&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;IntegerField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;number_of_portions&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;PositiveIntegerField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;difficulty&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;SmallIntegerField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;date_created&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;DateTimeField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;date_updated&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;DateTimeField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
    
    &lt;/TABLE&gt;
    &gt;]


}


  

  
  
  django_contrib_auth_models_User [label=&lt;
      &lt;TABLE BGCOLOR=&quot;palegoldenrod&quot; BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
      &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot; BGCOLOR=&quot;olivedrab4&quot;
      &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;white&quot;
      &gt;User&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;/TABLE&gt;
      &gt;]
  
  recipes_models_Recipe -&gt; django_contrib_auth_models_User
  [label=&quot;author (recipe)&quot;] [arrowhead=none, arrowtail=dot];
  
  
  recipes_models_Recipe -&gt; recipes_models_Category
  [label=&quot;category (recipe)&quot;] [arrowhead=dot arrowtail=dot, dir=both];
  

}" />
</p>
<ul class="simple">
<li>the app&#8217;s name is <em>recipes</em></li>
<li>there are two data models: <em>Recipe</em> and <em>Category</em></li>
<li>bold fields in the model are required</li>
<li>the field <em>id</em> will be generated automatically by Django&#8217;s ORM and used as primary key</li>
<li>both models are connected through a many-to-many relationship named <em>category</em></li>
<li><em>Recipe.author</em> is connected to the <em>User</em> model</li>
</ul>
<div class="section" id="creating-the-application">
<h2>Creating the application<a class="headerlink" href="#creating-the-application" title="Permalink to this headline">¶</a></h2>
<p>The application has to store recipes, so we name it <tt class="file docutils literal"><span class="pre">recipes</span></tt>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>cookbook
<span class="nv">$ </span>python manage.py startapp recipes
</pre></div>
</div>
<p>This command creates a folder <tt class="file docutils literal"><span class="pre">recipes</span></tt> which contains four files:</p>
<div class="highlight-bash"><div class="highlight"><pre>recipes/
|-- __init__.py
|-- models.py
|-- tests.py
<span class="sb">`</span>-- views.py
</pre></div>
</div>
<p>As in the <tt class="file docutils literal"><span class="pre">cookbook</span></tt> directory, the file <tt class="file docutils literal"><span class="pre">__index__.py</span></tt> makes the
folder a <a class="reference external" href="http://docs.python.org/tutorial/modules.html#packages">Python package</a>.
The application&#8217;s models go into <tt class="file docutils literal"><span class="pre">models.py</span></tt>. Tests go into <tt class="file docutils literal"><span class="pre">tests.py</span></tt>
and views into <tt class="file docutils literal"><span class="pre">views.py</span></tt>.</p>
</div>
<div class="section" id="the-models">
<h2>The models<a class="headerlink" href="#the-models" title="Permalink to this headline">¶</a></h2>
<p>Open the file <tt class="file docutils literal"><span class="pre">models.py</span></tt> in a text editor. It only contains an import:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">models</span></tt> module contains the fields and other parts of the ORM.</p>
<p>To make your life easier with special characters, add the following line above
the <tt class="docutils literal"><span class="pre">import</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># encoding: utf-8</span>
</pre></div>
</div>
<div class="section" id="the-model-for-the-categories">
<h3>The model for the categories<a class="headerlink" href="#the-model-for-the-categories" title="Permalink to this headline">¶</a></h3>
<p>Below these two lines we start with the first model for the categories:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A model class describing a category.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Name&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Description&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The model has three attributes which correspond to three rows in a table.
The field types define data type.</p>
<p>For instance the attribute <tt class="docutils literal"><span class="pre">name</span></tt> leads to <tt class="docutils literal"><span class="pre">VARCHAR(100)</span></tt> in the database.</p>
<p>The first parameter is optional and can be used to give the field a name
which will be used as label in the admin application.</p>
<p>The parameter <tt class="docutils literal"><span class="pre">blank=True</span></tt> allows the field to be empty. All fields are
required in default.</p>
<p>Now we extend the class <tt class="docutils literal"><span class="pre">Category</span></tt> with the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Category&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Categories&#39;</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>The class <tt class="docutils literal"><span class="pre">Meta</span></tt> has two attributes which define the model&#8217;s name.</p>
<p>The <tt class="docutils literal"><span class="pre">__unicode__</span></tt> method returns a unicode string. This will be used in
the admin application amongst other things.</p>
</div>
<div class="section" id="the-models-for-the-recipes">
<h3>The models for the recipes<a class="headerlink" href="#the-models-for-the-recipes" title="Permalink to this headline">¶</a></h3>
<p>Now we create the second model for the recipes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Recipe</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A model describing a coobook recipe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Title&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ingredients</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Indigrents&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;One indigrent per line&#39;</span><span class="p">)</span>
    <span class="n">preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Preparation&#39;</span><span class="p">)</span>
    <span class="n">time_for_preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="s">u&#39;Preparation time&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;In minutes&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">number_of_portions</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="s">u&#39;Number of portions&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This models is similar to the first one. We introduced the parameter
<tt class="docutils literal"><span class="pre">help_text</span></tt> which will be shown as help text in the admin application&#8217;s
edit mode.</p>
<p>There is also an <tt class="docutils literal"><span class="pre">IntegerField</span></tt>. You should use <tt class="docutils literal"><span class="pre">null=True</span></tt> here if no
input is required, because otherwise an empty string will be used.</p>
<p>Now add five more fields to the model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">difficulty</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s">u&#39;Difficulty&#39;</span><span class="p">)</span>
<span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Categories&#39;</span><span class="p">)</span>
<span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Author&#39;</span><span class="p">)</span>
<span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">date_updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we use a <tt class="docutils literal"><span class="pre">ManyToManyField</span></tt> to create a relation to the <tt class="docutils literal"><span class="pre">Category</span></tt>
model. The <tt class="docutils literal"><span class="pre">ManyToManyField</span></tt> expects the related model class as first
argument. Therefore we have to define the label in the admin interface with
the named parameter <tt class="docutils literal"><span class="pre">verbose_name</span></tt>.</p>
<p>The recipe&#8217;s author is stored in a <tt class="docutils literal"><span class="pre">ForeignKey</span></tt> field which represents a
many-to-one relation.</p>
<p>The time values shouldn&#8217;t be editable in the admin application, so we set
the parameter <tt class="docutils literal"><span class="pre">editable=False</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">User</span></tt> object has to be imported to be available. We import it from
Django&#8217;s auth application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</pre></div>
</div>
<p>The field <tt class="docutils literal"><span class="pre">difficulty</span></tt> is a <tt class="docutils literal"><span class="pre">SmallIntegerField</span></tt>. Because the users
shouldn&#8217;t have to enter a number but get a list, we create the choices at
the beginning of the model class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DIFFICULTY_EASY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">DIFFICULTY_MEDIUM</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">DIFFICULTY_HARD</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">DIFFICULTIES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">DIFFICULTY_EASY</span><span class="p">,</span> <span class="s">u&#39;easy&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">,</span> <span class="s">u&#39;normal&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">DIFFICULTY_HARD</span><span class="p">,</span> <span class="s">u&#39;hard&#39;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>These we link with the field <tt class="docutils literal"><span class="pre">difficulty</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">difficulty</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s">u&#39;Difficulty&#39;</span><span class="p">,</span>
    <span class="n">choices</span><span class="o">=</span><span class="n">DIFFICULTIES</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">)</span>
</pre></div>
</div>
<p>We also add a <tt class="docutils literal"><span class="pre">Meta</span></tt> class and a <tt class="docutils literal"><span class="pre">__unicode__</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Recipe&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Recipes&#39;</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-date_created&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
<p>In addition we use the attribute <tt class="docutils literal"><span class="pre">ordering</span></tt> in the <tt class="docutils literal"><span class="pre">Meta</span></tt> class to define
the default ordering.</p>
<p>The time values should be filled automatically because we didn&#8217;t allow them
to be edited in the admin application. To make this happen we override the
<tt class="docutils literal"><span class="pre">save</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_created</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date_updated</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Recipe</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>The field <tt class="docutils literal"><span class="pre">date_created</span></tt> only gets filled when the model is saved the first
time what is determined by <tt class="docutils literal"><span class="pre">id</span></tt> not having a value. The field
<tt class="docutils literal"><span class="pre">date_updated</span></tt> will be refreshed every time the model gets saved. At the
bottom of the <tt class="docutils literal"><span class="pre">save</span></tt> method we call the <a class="reference external" href="http://docs.python.org/library/functions.html#super">super</a> function.</p>
<p>The package now also has to be imported so we add the following line to the
top of the file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.timezone</span> <span class="kn">import</span> <span class="n">now</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can read more about <tt class="docutils literal"><span class="pre">import</span></tt> in <span class="target" id="index-0"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0008"><strong>PEP 8</strong></a>, in the
<a class="reference external" href="http://docs.python.org/reference/simple_stmts.html#import">Python documentation</a>
and in this <a class="reference external" href="http://effbot.org/zone/import-confusion.htm">article</a>.</p>
</div>
</div>
</div>
<div class="section" id="the-whole-file">
<h2>The whole file<a class="headerlink" href="#the-whole-file" title="Permalink to this headline">¶</a></h2>
<p>The file <tt class="docutils literal"><span class="pre">models.py</span></tt> now should look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># encoding: utf-8</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.timezone</span> <span class="kn">import</span> <span class="n">now</span>


<span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A model class describing a category.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Name&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Description&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Category&#39;</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Categories&#39;</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


<span class="k">class</span> <span class="nc">Recipe</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A model describing a coobook recipe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DIFFICULTY_EASY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">DIFFICULTY_MEDIUM</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">DIFFICULTY_HARD</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">DIFFICULTIES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">DIFFICULTY_EASY</span><span class="p">,</span> <span class="s">u&#39;easy&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">,</span> <span class="s">u&#39;normal&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">DIFFICULTY_HARD</span><span class="p">,</span> <span class="s">u&#39;hard&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Title&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ingredients</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Indigrents&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;One indigrent per line&#39;</span><span class="p">)</span>
    <span class="n">preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Preparation&#39;</span><span class="p">)</span>
    <span class="n">time_for_preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="s">u&#39;Preparation time&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;Zeit in Minuten angeben&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">number_of_portions</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="s">u&#39;Number of portions&#39;</span><span class="p">)</span>
    <span class="n">difficulty</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s">u&#39;Difficulty&#39;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">DIFFICULTIES</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Categories&#39;</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Author&#39;</span><span class="p">)</span>
    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">date_updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Recipe&#39;</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Recipes&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-date_created&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_created</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_updated</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Recipe</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="activating-the-application">
<h2>Activating the application<a class="headerlink" href="#activating-the-application" title="Permalink to this headline">¶</a></h2>
<p>To use the application in our project, it has to be activated in the
configuration.</p>
<p>Open the file <tt class="file docutils literal"><span class="pre">settings.py</span></tt> and add the application&#8217;s name the end
of <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> now looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sites&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="s">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s">&#39;recipes&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://docs.djangoproject.com/en/1.4/topics/db/models/#topics-db-models">Basic information about models</a></li>
<li><a class="reference external" href="https://docs.djangoproject.com/en/1.4/ref/models/fields/#ref-models-fields">Django&#8217;s built-in fields</a></li>
<li><a class="reference external" href="https://docs.djangoproject.com/en/1.4/ref/models/options/#ref-models-options">The parameters of the Meta class</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The first application</a><ul>
<li><a class="reference internal" href="#creating-the-application">Creating the application</a></li>
<li><a class="reference internal" href="#the-models">The models</a><ul>
<li><a class="reference internal" href="#the-model-for-the-categories">The model for the categories</a></li>
<li><a class="reference internal" href="#the-models-for-the-recipes">The models for the recipes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-whole-file">The whole file</a></li>
<li><a class="reference internal" href="#activating-the-application">Activating the application</a></li>
<li><a class="reference internal" href="#resources">Resources</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="testserver.html"
                        title="previous chapter">Development Webserver</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="admin.html"
                        title="next chapter">The admin application</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/first_steps/app.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="admin.html" title="The admin application"
             >next</a> |</li>
        <li class="right" >
          <a href="testserver.html" title="Development Webserver"
             >previous</a> |</li>
        <li><a href="../index.html">Django 101 Tutorial</a> &raquo;</li>
          <li><a href="index.html" >Erste Schritte mit Django</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright .
    <br />Dieses Werk ist unter einem <a href="http://creativecommons.org/licenses/by-sa/3.0/de/">Creative Commons Namensnennung-Weitergabe unter gleichen Bedingungen 3.0 Deutschland Lizenzvertrag</a> lizenziert.<br />
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>