
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Die erste Applikation &mdash; Django 101 Tutorial</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Django 101 Tutorial" href="../index.html" />
    <link rel="up" title="Erste Schritte mit Django" href="index.html" />
    <link rel="next" title="Die Admin-Applikation" href="admin.html" />
    <link rel="prev" title="Entwicklungs-Webserver" href="testserver.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Allgemeiner Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="admin.html" title="Die Admin-Applikation"
             accesskey="N">weiter</a> |</li>
        <li class="right" >
          <a href="testserver.html" title="Entwicklungs-Webserver"
             accesskey="P">zurück</a> |</li>
        <li><a href="../index.html">Django 101 Tutorial</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Erste Schritte mit Django</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="die-erste-applikation">
<h1>Die erste Applikation<a class="headerlink" href="#die-erste-applikation" title="Permalink zu dieser Überschrift">¶</a></h1>
<p>Nun beginnen wir mit der ersten Applikation für unser Projekt &#8220;Kochbuch&#8221;.</p>
<p>Das Datenmodell ist wie folgt aufgebaut:</p>
<p class="graphviz">
<img src="../_images/graphviz-b80512f431c537d3f35b079932ae80e48eaf1185.png" alt="digraph name {
  fontname = &quot;Helvetica&quot;
  fontsize = 8

  node [
    fontname = &quot;Helvetica&quot;
    fontsize = 8
    shape = &quot;plaintext&quot;
  ]
  edge [
    fontname = &quot;Helvetica&quot;
    fontsize = 8
  ]



subgraph cluster_recipes_models {
  label=&lt;
        &lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
        &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;Black&quot; POINT-SIZE=&quot;12&quot;
        &gt;recipes&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
        &lt;/TABLE&gt;
        &gt;
  color=olivedrab4
  style=&quot;rounded&quot;


    recipes_models_Category [label=&lt;
    &lt;TABLE BGCOLOR=&quot;palegoldenrod&quot; BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
     &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot; BGCOLOR=&quot;olivedrab4&quot;
     &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;white&quot;
     &gt;Category&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
    
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;id&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;AutoField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;name&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;CharField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;slug&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;SlugField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;description&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;TextField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
    
    &lt;/TABLE&gt;
    &gt;]

    recipes_models_Recipe [label=&lt;
    &lt;TABLE BGCOLOR=&quot;palegoldenrod&quot; BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
     &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot; BGCOLOR=&quot;olivedrab4&quot;
     &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;white&quot;
     &gt;Recipe&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
    
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;id&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;AutoField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;title&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;CharField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;slug&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;SlugField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;ingredients&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;TextField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;preparation&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;TextField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;time_for_preparation&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT COLOR=&quot;#7B7B7B&quot; FACE=&quot;Helvetica Bold&quot;&gt;IntegerField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;number_of_portions&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;PositiveIntegerField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;difficulty&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;SmallIntegerField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;date_created&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;DateTimeField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
        &lt;TR&gt;&lt;TD ALIGN=&quot;LEFT&quot; BORDER=&quot;0&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;date_updated&lt;/FONT
        &gt;&lt;/TD&gt;
        &lt;TD ALIGN=&quot;LEFT&quot;
        &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot;&gt;DateTimeField&lt;/FONT
        &gt;&lt;/TD&gt;&lt;/TR&gt;
        
    
    &lt;/TABLE&gt;
    &gt;]


}


  

  
  
  django_contrib_auth_models_User [label=&lt;
      &lt;TABLE BGCOLOR=&quot;palegoldenrod&quot; BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot;&gt;
      &lt;TR&gt;&lt;TD COLSPAN=&quot;2&quot; CELLPADDING=&quot;4&quot; ALIGN=&quot;CENTER&quot; BGCOLOR=&quot;olivedrab4&quot;
      &gt;&lt;FONT FACE=&quot;Helvetica Bold&quot; COLOR=&quot;white&quot;
      &gt;User&lt;/FONT&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;/TABLE&gt;
      &gt;]
  
  recipes_models_Recipe -&gt; django_contrib_auth_models_User
  [label=&quot;author (recipe)&quot;] [arrowhead=none, arrowtail=dot];
  
  
  recipes_models_Recipe -&gt; recipes_models_Category
  [label=&quot;category (recipe)&quot;] [arrowhead=dot arrowtail=dot, dir=both];
  

}" />
</p>
<ul class="simple">
<li>unsere App heisst <em>recipes</em></li>
<li>es gibt zwei Models: <em>Recipe</em> und <em>Category</em></li>
<li>im Datenmodell fett gedruckte Felder sind Pflichtfelder</li>
<li>das Feld <em>id</em> wird vom Django ORM automatisch als Primärschlüssel angelegt</li>
<li>beide Models sind durch eine n-m Verknüpfung <em>category</em> verbunden</li>
<li><em>Recipe.author</em> ist mit dem <em>User</em> Model verbunden</li>
</ul>
<div class="section" id="anlegen-der-applikation">
<h2>Anlegen der Applikation<a class="headerlink" href="#anlegen-der-applikation" title="Permalink zu dieser Überschrift">¶</a></h2>
<p>Die Applikation soll die Rezepte verwalten, also nennen wir sie
<tt class="file docutils literal"><span class="pre">recipes</span></tt>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>cookbook
<span class="nv">$ </span>python manage.py startapp recipes
</pre></div>
</div>
<p>Das Kommando legt ein Verzeichnis <tt class="file docutils literal"><span class="pre">recipes</span></tt> an, in dem sich vier Dateien
befinden:</p>
<div class="highlight-bash"><div class="highlight"><pre>recipes/
|-- __init__.py
|-- models.py
|-- tests.py
<span class="sb">`</span>-- views.py
</pre></div>
</div>
<p>Die Datei <tt class="file docutils literal"><span class="pre">__init__.py</span></tt> definiert, wie schon beim
Konfigurationsverzeichnis, dass das Verzeichnis <tt class="file docutils literal"><span class="pre">recipes</span></tt> ein <a class="reference external" href="http://docs.python.org/tutorial/modules.html#packages">Python
Paket</a> ist. Die Models
der Applikation werden wir gleich in der Datei <tt class="file docutils literal"><span class="pre">models.py</span></tt> anlegen. Tests
werden in der Datei <tt class="file docutils literal"><span class="pre">tests.py</span></tt> erstellt. Die Datei <tt class="file docutils literal"><span class="pre">views.py</span></tt>
enthält die Views der Applikation.</p>
</div>
<div class="section" id="die-models">
<h2>Die Models<a class="headerlink" href="#die-models" title="Permalink zu dieser Überschrift">¶</a></h2>
<p>Öffne die Datei <tt class="file docutils literal"><span class="pre">models.py</span></tt> in einem Texteditor. Sie enthält nur einen
<tt class="docutils literal"><span class="pre">import</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
</pre></div>
</div>
<p>Damit wird das Paket, dass die Felder und andere Teile des ORMs enthält,
geladen.</p>
<p>Damit du später keine Probleme mit dem Encoding bekommst füge noch vor dem
<tt class="docutils literal"><span class="pre">import</span></tt> folgende Zeile hinzu:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># encoding: utf-8</span>
</pre></div>
</div>
<div class="section" id="ein-model-fur-die-kategorien">
<h3>Ein Model für die Kategorien<a class="headerlink" href="#ein-model-fur-die-kategorien" title="Permalink zu dieser Überschrift">¶</a></h3>
<p>Unter diesen beiden Zeilen beginnen wir mit dem ersten Model für die
Kategorien:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Category model.&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Name&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Beschreibung&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Das Model hat nun drei Attribute, die drei Feldern in einer Tabelle
entsprechen. Die Feldtypen definieren den Datentyp.</p>
<p>Das Attribut <tt class="docutils literal"><span class="pre">name</span></tt> entspricht zum Beispiel einem <tt class="docutils literal"><span class="pre">VARCHAR(100)</span></tt> in der
Datenbank.</p>
<p>Als ersten Parameter kann man optional einen Titel für das Feld angeben, der
dann in der Admin-Applikation benutzt wird.</p>
<p>Der Parameter <tt class="docutils literal"><span class="pre">blank=True</span></tt> ermöglicht es dieses Feld leer zu lassen. Alle
Felder eines Models sind also Pflichtfelder.</p>
<p>Nun wird die Klasse <tt class="docutils literal"><span class="pre">Category</span></tt> noch mit dem folgenden Code erweitert:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Kategorie&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Kategorien&#39;</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>Die Klasse <tt class="docutils literal"><span class="pre">Meta</span></tt> hat zwei Attribute, die den Namen des Models bestimmen.</p>
<p>Die Methode <tt class="docutils literal"><span class="pre">__unicode__</span></tt> soll einen Unicode-String zurückgeben. Dies wird
zum Beispiel in der Admin-Applikation benutzt.</p>
</div>
<div class="section" id="das-model-fur-die-rezepte">
<h3>Das Model für die Rezepte<a class="headerlink" href="#das-model-fur-die-rezepte" title="Permalink zu dieser Überschrift">¶</a></h3>
<p>Jetzt legen wir das zweite Model für die Rezepte an:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Recipe</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Recipe model.&quot;&quot;&quot;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Titel&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ingredients</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Zutaten&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;Eine Zutat pro Zeile angeben&#39;</span><span class="p">)</span>
    <span class="n">preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Zubereitung&#39;</span><span class="p">)</span>
    <span class="n">time_for_preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="s">u&#39;Zubereitungszeit&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;Zeit in Minuten angeben&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">number_of_portions</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="s">u&#39;Anzahl der Portionen&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Das Model ist dem ersten ähnlich. Neu ist der Parameter <tt class="docutils literal"><span class="pre">help_text</span></tt>, der in
der Bearbeitungsansicht der Admin-Applikation als Hilfe benutzt wird.</p>
<p>Neu ist auch das <tt class="docutils literal"><span class="pre">IntegerField</span></tt>. Wenn man bei diesem keine Eingabe verlangt
sollte man den Parameter <tt class="docutils literal"><span class="pre">null=True</span></tt> benutzen, denn sonst wird ein leerer
String benutzt.</p>
<p>Außerdem bekommt das Model noch fünf weitere Felder:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">difficulty</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s">u&#39;Schwierigkeitsgrad&#39;</span><span class="p">)</span>
<span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Kategorien&#39;</span><span class="p">)</span>
<span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Autor&#39;</span><span class="p">)</span>
<span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">date_updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Hier stellen wir eine Relation zum Model <tt class="docutils literal"><span class="pre">Category</span></tt> mit Hilfe des Feldtyps
<tt class="docutils literal"><span class="pre">ManyToManyField</span></tt> her. Da dieser als erstes Argument die Klasse erwartet,
mit der die Relation hergestellt werden soll, müssen wir den Bezeichner des
Felds in der Admin-Applikation mit dem Parameter <tt class="docutils literal"><span class="pre">verbose_name</span></tt> angeben.</p>
<p>Den Autor eines Rezepts legen wir über einen <tt class="docutils literal"><span class="pre">ForeignKey</span></tt> fest, also eine
1-n Beziehnung.</p>
<p>Die Zeitangaben sollen nicht in der Admin-Applikation bearbeitet werden,
deshalb benutzen wir den Parameter <tt class="docutils literal"><span class="pre">editable=False</span></tt>.</p>
<p>Damit das Objekt <tt class="docutils literal"><span class="pre">User</span></tt> auch zur Verfügung steht muss vor dem ersten
<tt class="docutils literal"><span class="pre">import</span></tt> ein weiterer eingefügt werden:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</pre></div>
</div>
<p>Wir importieren das Model <tt class="docutils literal"><span class="pre">User</span></tt> aus einer Applikation mit dem Namen
<tt class="docutils literal"><span class="pre">auth</span></tt>, die Django mitbringt.</p>
<p>Das Feld <tt class="docutils literal"><span class="pre">difficulty</span></tt> ist vom Typ <tt class="docutils literal"><span class="pre">SmallIntegerField</span></tt>. Nun sollen die
Benutzer nicht eine Zahl eingeben, sondern eine Auswahlliste benutzen. Deshalb
legen wir am Anfang der Klasse eine Liste von Auswahlmöglichkeiten an:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DIFFICULTY_EASY</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">DIFFICULTY_MEDIUM</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">DIFFICULTY_HARD</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">DIFFICULTIES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">DIFFICULTY_EASY</span><span class="p">,</span> <span class="s">u&#39;einfach&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">,</span> <span class="s">u&#39;normal&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">DIFFICULTY_HARD</span><span class="p">,</span> <span class="s">u&#39;schwer&#39;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Diese Verknüpfen wir mit dem Feld:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">difficulty</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s">u&#39;Schwierigkeitsgrad&#39;</span><span class="p">,</span>
    <span class="n">choices</span><span class="o">=</span><span class="n">DIFFICULTIES</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">)</span>
</pre></div>
</div>
<p>Zuletzt muss wieder eine <tt class="docutils literal"><span class="pre">Meta</span></tt> Klasse und eine <tt class="docutils literal"><span class="pre">__unicode__</span></tt> Methode
erstellt werden:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Rezept&#39;</span>
    <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Rezepte&#39;</span>
    <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-date_created&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
<p>Zusätzlich benutzen wir das Attribut <tt class="docutils literal"><span class="pre">ordering</span></tt> der <tt class="docutils literal"><span class="pre">Meta</span></tt> Klasse, um die
Standardsortierung der Datensätze zu bestimmen.</p>
<p>Außerdem wollen wir, dass die Zeitangaben automatisch ausgefüllt werden, da
sie ja nicht in der Admin-Applikation bearbeitet werden können. Dazu
überschreiben wir die Methode <tt class="docutils literal"><span class="pre">save</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_created</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date_updated</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Recipe</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Das Feld <tt class="docutils literal"><span class="pre">date_created</span></tt> wird nur gefüllt, wenn das Model zum ersten mal
gespeichert wird und daher noch kein Attribut <tt class="docutils literal"><span class="pre">id</span></tt> besitzt. Das Feld
<tt class="docutils literal"><span class="pre">date_updated</span></tt> wird bei jedem Speichern aktualisiert. Am Ende wird die
<tt class="docutils literal"><span class="pre">save</span></tt> Methode der Elternklasse mit Hilfe der Funktion <a class="reference external" href="http://docs.python.org/library/functions.html#super">super</a> aufgerufen.</p>
<p>Das Paket <tt class="docutils literal"><span class="pre">now</span></tt> müssen wir ebenfalls noch importieren. Also schreiben wir an
den Anfang der Datei:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.timezone</span> <span class="kn">import</span> <span class="n">now</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Mehr zum Thema <tt class="docutils literal"><span class="pre">import</span></tt> kannst du im <span class="target" id="index-0"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0008"><strong>PEP 8</strong></a>, in der <a class="reference external" href="http://docs.python.org/reference/simple_stmts.html#import">Python Dokumentation</a> sowie diesem
<a class="reference external" href="http://effbot.org/zone/import-confusion.htm">kurzen Artikel</a> nachlesen.</p>
</div>
</div>
</div>
<div class="section" id="die-vollstandige-datei">
<h2>Die vollständige Datei<a class="headerlink" href="#die-vollstandige-datei" title="Permalink zu dieser Überschrift">¶</a></h2>
<p>Die Datei <tt class="docutils literal"><span class="pre">models.py</span></tt> sollte nun so aussehen:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># encoding: utf-8</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.timezone</span> <span class="kn">import</span> <span class="n">now</span>


<span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Category model.&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Name&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Beschreibung&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Kategorie&#39;</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Kategorien&#39;</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


<span class="k">class</span> <span class="nc">Recipe</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Recipe model.&quot;&quot;&quot;</span>
    <span class="n">DIFFICULTY_EASY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">DIFFICULTY_MEDIUM</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">DIFFICULTY_HARD</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">DIFFICULTIES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">DIFFICULTY_EASY</span><span class="p">,</span> <span class="s">u&#39;einfach&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">,</span> <span class="s">u&#39;normal&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">DIFFICULTY_HARD</span><span class="p">,</span> <span class="s">u&#39;schwer&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s">u&#39;Titel&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ingredients</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Zutaten&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;Eine Zutat pro Zeile angeben&#39;</span><span class="p">)</span>
    <span class="n">preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="s">u&#39;Zubereitung&#39;</span><span class="p">)</span>
    <span class="n">time_for_preparation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="s">u&#39;Zubereitungszeit&#39;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">u&#39;Zeit in Minuten angeben&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">number_of_portions</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="s">u&#39;Anzahl der Portionen&#39;</span><span class="p">)</span>
    <span class="n">difficulty</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s">u&#39;Schwierigkeitsgrad&#39;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">DIFFICULTIES</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DIFFICULTY_MEDIUM</span><span class="p">)</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Category</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Kategorien&#39;</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">u&#39;Autor&#39;</span><span class="p">)</span>
    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">date_updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">u&#39;Rezept&#39;</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="s">u&#39;Rezepte&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-date_created&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_created</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_updated</span> <span class="o">=</span> <span class="n">now</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Recipe</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="die-applikation-aktivieren">
<h2>Die Applikation aktivieren<a class="headerlink" href="#die-applikation-aktivieren" title="Permalink zu dieser Überschrift">¶</a></h2>
<p>Damit wir die Applikation im Projekt nutzen können müssen wir sie in die
Konfiguration eintragen.</p>
<p>Öffne dazu die Datei <tt class="file docutils literal"><span class="pre">settings.py</span></tt> und füge den Namen unserer
Applikation am Ende von <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> ein.</p>
<p>Danach sieht <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> so aus:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sites&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="c"># &#39;django.contrib.admin&#39;,</span>
    <span class="s">&#39;recipes&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="weiterfuhrende-links-zur-django-dokumentation">
<h2>Weiterführende Links zur Django Dokumentation<a class="headerlink" href="#weiterfuhrende-links-zur-django-dokumentation" title="Permalink zu dieser Überschrift">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://docs.djangoproject.com/en/1.4/topics/db/models/#topics-db-models">Allgemeine Informationen zu den Models</a></li>
<li><a class="reference external" href="https://docs.djangoproject.com/en/1.4/ref/models/fields/#ref-models-fields">Alle in Django enthaltenen Feldtypen</a></li>
<li><a class="reference external" href="https://docs.djangoproject.com/en/1.4/ref/models/options/#ref-models-options">Die Parameter der Meta Klasse</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Inhalt</a></h3>
  <ul>
<li><a class="reference internal" href="#">Die erste Applikation</a><ul>
<li><a class="reference internal" href="#anlegen-der-applikation">Anlegen der Applikation</a></li>
<li><a class="reference internal" href="#die-models">Die Models</a><ul>
<li><a class="reference internal" href="#ein-model-fur-die-kategorien">Ein Model für die Kategorien</a></li>
<li><a class="reference internal" href="#das-model-fur-die-rezepte">Das Model für die Rezepte</a></li>
</ul>
</li>
<li><a class="reference internal" href="#die-vollstandige-datei">Die vollständige Datei</a></li>
<li><a class="reference internal" href="#die-applikation-aktivieren">Die Applikation aktivieren</a></li>
<li><a class="reference internal" href="#weiterfuhrende-links-zur-django-dokumentation">Weiterführende Links zur Django Dokumentation</a></li>
</ul>
</li>
</ul>

  <h4>Vorheriges Thema</h4>
  <p class="topless"><a href="testserver.html"
                        title="vorheriges Kapitel">Entwicklungs-Webserver</a></p>
  <h4>Nächstes Thema</h4>
  <p class="topless"><a href="admin.html"
                        title="nächstes Kapitel">Die Admin-Applikation</a></p>
  <h3>Diese Seite</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/erste_schritte/app.txt"
           rel="nofollow">Quelltext anzeigen</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Schnellsuche</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Los" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Geben Sie Suchbegriffe oder einen Modul-, Klassen- oder Funktionsnamen ein.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Allgemeiner Index"
             >Index</a></li>
        <li class="right" >
          <a href="admin.html" title="Die Admin-Applikation"
             >weiter</a> |</li>
        <li class="right" >
          <a href="testserver.html" title="Entwicklungs-Webserver"
             >zurück</a> |</li>
        <li><a href="../index.html">Django 101 Tutorial</a> &raquo;</li>
          <li><a href="index.html" >Erste Schritte mit Django</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright .
    <br />Dieses Werk ist unter einem <a href="http://creativecommons.org/licenses/by-sa/3.0/de/">Creative Commons Namensnennung-Weitergabe unter gleichen Bedingungen 3.0 Deutschland Lizenzvertrag</a> lizenziert.<br />
      Mit <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3 erstellt.
    </div>
  </body>
</html>